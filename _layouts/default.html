<!DOCTYPE html>
<html>
    <head>
        <title>{{ page.title }}</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet subresource">
        <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700" rel="stylesheet subresource">
        <link rel='stylesheet prefetch' href='http://cdn.zekken.rocks/css/waves.css'>
        <link rel="stylesheet" type="text/css" href="/css/main.css">
    </head>
    <body>
        <div class="sidebar">
            <a class="sidebar-toggle waves-effect" href="#">Sidebar Toggle</a>
            <ul class="sidebar-menu custom-scrollbar">
                {% for post in site.posts %}
                    <li>
                        <a href="{{ post.url }}">
                            <i class="material-icons">label</i>
                            {{ post.title }}
                        </a>
                    </li>
                {% endfor %}
            </ul>
        </div>

        <div class="wrapper">
            <header>
                <div class="container">
                    <div class="header-content content-wrapper">
                    <div class="header-title">
                        <h1>{{ page.title }}</h1>
                    </div>
                    </div>
                </div>
            </header>
            <div class="body custom-scrollbar">
                <div class="container">
                    <div class="markdown content-wrapper">{{ content }}</div>
                </div>
            </div>
        </div>
        
        <script src='http://cdn.zekken.rocks/js/addons/waves.js'></script>

        <script>
            'use strict';

            if (typeof NodeList.prototype.forEach === 'undefined') {
                // Polyfill for nodelist foreach for ie11
                NodeList.prototype.forEach = function (callback, scope) {
                    for (var i = 0; i < this.length; i++) {
                        callback.call(scope, this[i], i); // passes back stuff we need
                    }
                };
            }

            // Cross browser friendly matches
            var matches = function matches(el, selector) {
                return (el.matches || el.matchesSelector || el.msMatchesSelector || el.mozMatchesSelector || el.webkitMatchesSelector || el.oMatchesSelector).call(el, selector);
            };

            // Get the dom element's children
            var getChildren = function getChildren(el, selector) {
                return [].some.call(el.children, function (e) {
                    return matches(e, selector);
                });
            };

            // Open and close the sidebar
            document.querySelector('.sidebar-toggle').addEventListener('click', function (e) {
                document.querySelector('.sidebar').classList.toggle('side-bar-closed');
                return false;
            });

            // Open and close the navlinks
            var navlinks = document.querySelectorAll('.sidebar ul a');
            navlinks.forEach(function (link) {
                // Remove links that have children and add the class to the li wrapper
                if (getChildren(link.parentNode, 'ul')) {
                    link.parentNode.classList.add('has-children');
                    link.setAttribute('tabindex', '-1');
                }

                link.addEventListener('click', function (e) {
                    if (getChildren(link.parentNode, 'ul')) {
                        e.preventDefault();

                        link.parentNode.classList.toggle('active');
                        link.parentNode.querySelectorAll('.active').forEach(function (active) {
                            active.classList.toggle('active');
                        });

                        return false;
                    }
                });
            });

            // Add data-title attribute for relevant items in table after parsing
            var tables = document.querySelectorAll('.markdown table');
            tables.forEach(function (table) {
                var headers = table.querySelectorAll('thead th');
                var rows = table.querySelectorAll('tbody tr');
                rows.forEach(function (row) {
                    var cells = row.querySelectorAll('td, th');

                    cells.forEach(function (cell, index) {
                        cell.setAttribute('data-title', headers[index].innerText);
                    });
                });
            });
        </script>
    </body>
</html>
